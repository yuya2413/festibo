<div class="hotel-index-pilot" style="background-color: linen;">


<h1>"<%= @festival.name %>"付近のホテル一覧</h1>
<p>会場: <%= @festival.address %></p>




















<!--下記、Google Map表示-->
<h2>gmap</h2>
latitude:<%= @festival.latitude %><br>
longitude:<%= @festival.longitude %>
<style>
#map{
  height: 500px;
  width: 80%;
  left: 10%;
}
</style>

        <div id="map"></div>
        <script>
          function initMap() {
            var latlng = new google.maps.LatLng(<%= @festival.latitude %>, <%= @festival.longitude %>);
            var map = new google.maps.Map(document.getElementById('map'), {
              center: latlng,
              zoom: 15,
            });
            var marker = new google.maps.Marker({
                position: latlng,
                map: map,
              });
            var transitLayer = new google.maps.TransitLayer();
            transitLayer.setMap(map);


            //Hotelマーカー ここから
            <% @hotels.each do |hotel| %>
            (function(){
              var contentString = '<div><%= link_to hotel.name, new_users_user_reservation_path(current_user, params: {festival_id: @festival.id, hotel_id: hotel.id}), style: "color: #0000ee; font-weight: bold;" %></div><div><%= hotel.address %></div>';
              var infoWindow =new google.maps.InfoWindow({
                content: contentString
              });
              var marker = new google.maps.Marker({
                position: {lat: <%= hotel.latitude %>, lng: <%= hotel.longitude %>},
                map: map,
                title: contentString
              });
              marker.addListener('click', function(){
                infoWindow.open(map, marker);
              });
            })();
            <% end %>
            //Hotelマーカーここまで
          }





        </script>




    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwNc99Q2u5MzbjDkJp3kb1u2IH_-ofbBk&callback=initMap"
    ></script>





























<table class="table table-hover">
  <thead>
    <tr>
            <th>ID</th>
            <th>ホテル名</th>
      <th>ホテル住所</th>
      <th>ホテル画像数</th>
        <th>ホテル部屋タイプ数</th>
        <th>都道府県ID</th>
    </tr>
  </thead>
  <tbody>
      <% @hotels.each do |hotel|%>
      <tr>
        <th><%= hotel.id %></th>
        <% if user_signed_in? %>
          <td><%= link_to hotel.name, new_users_user_reservation_path(current_user, params: {festival_id: @festival.id, hotel_id: hotel.id}) %></td>
        <% else %>
          <td><%= hotel.name %></td>
        <% end %>
        <td><%= hotel.address %></td>
        <td><%= hotel.hotel_photos.count %></td>
        <td><%= hotel.room_types.count %></td>
        <td><%= hotel.prefecture_id %></td>
      </tr>
      <% end %>
  </tbody>
</table>

</div>


